# ==================== TradeMaster Web Backend 环境变量配置示例 ====================
# 后端应用专用环境变量配置
# 这些变量主要由FastAPI后端应用使用

# ==================== 基础应用配置 ====================
# 应用基本信息
APP_NAME=TradeMaster Web Backend
APP_VERSION=1.0.0
APP_DESCRIPTION=TradeMaster Web Interface Backend API
DEBUG=false
LOG_LEVEL=INFO

# 环境配置
ENVIRONMENT=production
PYTHON_ENV=production

# ==================== 服务器配置 ====================
# FastAPI服务器配置
SERVER_HOST=0.0.0.0
SERVER_PORT=8000
SERVER_RELOAD=false
SERVER_WORKERS=4

# API配置
API_V1_STR=/api/v1
API_TITLE=TradeMaster Web API
API_DESCRIPTION=TradeMaster Web Interface Backend API Documentation

# ==================== 数据库配置 ====================
# PostgreSQL数据库连接
DATABASE_URL=postgresql://user:password@localhost:5432/dbname
DB_HOST=localhost
DB_PORT=5432
DB_USER=trademaster
DB_PASSWORD=CHANGE_THIS_DATABASE_PASSWORD
DB_NAME=trademaster_web

# 数据库连接池配置
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=50
DB_POOL_TIMEOUT=60
DB_POOL_RECYCLE=3600
DB_POOL_PRE_PING=true

# 数据库引擎配置
DB_ECHO=false
DB_ECHO_POOL=false
DB_POOL_RESET_ON_RETURN=commit

# ==================== Redis缓存配置 ====================
# Redis连接配置
REDIS_URL=redis://localhost:6379/0
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=CHANGE_THIS_REDIS_PASSWORD
REDIS_SSL=false

# Redis连接池配置
REDIS_MAX_CONNECTIONS=20
REDIS_CONNECTION_TIMEOUT=10
REDIS_SOCKET_TIMEOUT=10

# 缓存策略配置
CACHE_DEFAULT_EXPIRE=3600
CACHE_PREFIX=trademaster:backend:
CACHE_ENABLED=true

# ==================== JWT安全配置 ====================
# JWT令牌配置
SECRET_KEY=CHANGE_THIS_TO_A_VERY_STRONG_RANDOM_SECRET_KEY_AT_LEAST_64_CHARACTERS_LONG
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# JWT令牌前缀
TOKEN_TYPE=Bearer
TOKEN_URL=token

# ==================== 密码安全配置 ====================
# 密码哈希配置
BCRYPT_ROUNDS=12
PBKDF2_ITERATIONS=100000
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_SPECIAL=true
PASSWORD_REQUIRE_UPPER=true
PASSWORD_REQUIRE_LOWER=true
PASSWORD_REQUIRE_DIGIT=true

# ==================== CORS配置 ====================
# 跨域资源共享配置
BACKEND_CORS_ORIGINS=["http://localhost:3000","https://yourdomain.com"]
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=["GET","POST","PUT","DELETE","OPTIONS","PATCH"]
CORS_ALLOW_HEADERS=["*"]
CORS_EXPOSE_HEADERS=["*"]
CORS_MAX_AGE=86400

# ==================== API安全配置 ====================
# API限流配置
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_BURST=20
RATE_LIMIT_STORAGE_URL=redis://localhost:6379/1

# API安全头配置
SECURITY_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000
CONTENT_TYPE_NOSNIFF=true
FRAME_OPTIONS=DENY
XSS_PROTECTION=true

# ==================== 文件上传配置 ====================
# 文件上传限制
MAX_UPLOAD_SIZE=104857600
UPLOAD_DIRECTORY=uploads
ALLOWED_EXTENSIONS=[".csv",".json",".xlsx",".xls",".parquet",".py",".ipynb"]
UPLOAD_TEMP_DIRECTORY=temp

# 文件存储配置
STATIC_FILES_DIRECTORY=static
MEDIA_FILES_DIRECTORY=media
DATA_FILES_DIRECTORY=data

# ==================== 日志配置 ====================
# 应用日志配置
LOG_FORMAT=json
LOG_DATE_FORMAT=%Y-%m-%d %H:%M:%S
LOG_FILE_ENABLED=true
LOG_FILE_PATH=logs/app.log
LOG_FILE_MAX_SIZE=52428800
LOG_FILE_BACKUP_COUNT=20
LOG_FILE_ENCODING=utf-8

# 日志级别配置
LOG_LEVEL_ROOT=INFO
LOG_LEVEL_UVICORN=INFO
LOG_LEVEL_DATABASE=WARNING
LOG_LEVEL_CACHE=WARNING

# ==================== 外部服务配置 ====================
# TradeMaster核心API配置
TRADEMASTER_API_URL=http://localhost:8080
TRADEMASTER_API_TIMEOUT=600
TRADEMASTER_API_RETRY_ATTEMPTS=3
TRADEMASTER_API_RETRY_DELAY=10
TRADEMASTER_API_KEY=your-api-key-here

# TradeMaster数据路径配置
TRADEMASTER_DATA_PATH=/app/trademaster_data
TRADEMASTER_CONFIG_PATH=/app/trademaster_configs
TRADEMASTER_MODEL_PATH=/app/trademaster_models

# ==================== 邮件服务配置 ====================
# SMTP邮件配置
SMTP_ENABLED=true
SMTP_HOST=smtp.yourdomain.com
SMTP_PORT=587
SMTP_USER=noreply@yourdomain.com
SMTP_PASSWORD=CHANGE_THIS_EMAIL_PASSWORD
SMTP_TLS=true
SMTP_SSL=false
SMTP_START_TLS=true

# 邮件模板配置
EMAIL_FROM_NAME=TradeMaster Team
EMAIL_FROM_ADDRESS=noreply@yourdomain.com
EMAIL_TEMPLATES_DIR=templates/email
EMAIL_RESET_TOKEN_EXPIRE_HOURS=48

# ==================== 错误监控配置 ====================
# Sentry错误追踪
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENABLED=true
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1

# ==================== 性能监控配置 ====================
# Prometheus指标配置
METRICS_ENABLED=true
METRICS_ENDPOINT=/metrics
METRICS_PORT=9090
METRICS_INCLUDE_REQUEST_TIME=true
METRICS_INCLUDE_REQUEST_COUNT=true

# 健康检查配置
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_ENDPOINT=/health
HEALTH_CHECK_INCLUDE_DB=true
HEALTH_CHECK_INCLUDE_REDIS=true
HEALTH_CHECK_INCLUDE_EXTERNAL=true

# ==================== WebSocket配置 ====================
# WebSocket连接配置
WEBSOCKET_ENABLED=true
WEBSOCKET_PATH=/ws
WEBSOCKET_MAX_CONNECTIONS=1000
WEBSOCKET_HEARTBEAT_INTERVAL=60
WEBSOCKET_MESSAGE_QUEUE_SIZE=1000

# ==================== 数据处理配置 ====================
# 异步任务配置
CELERY_BROKER_URL=redis://localhost:6379/2
CELERY_RESULT_BACKEND=redis://localhost:6379/3
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=["json"]
CELERY_TIMEZONE=Asia/Shanghai

# 数据处理配置
DATA_PROCESSING_ENABLED=true
DATA_PROCESSING_CHUNK_SIZE=10000
DATA_PROCESSING_MAX_WORKERS=8
DATA_PROCESSING_TIMEOUT=3600

# ==================== 模型训练配置 ====================
# 训练任务配置
TRAINING_ENABLED=true
TRAINING_MAX_CONCURRENT_JOBS=4
TRAINING_CHECKPOINT_INTERVAL=200
TRAINING_EARLY_STOPPING_PATIENCE=20
TRAINING_MAX_EPOCHS=1000
TRAINING_TIMEOUT=86400

# 模型存储配置
MODEL_STORAGE_PATH=models
MODEL_CHECKPOINT_PATH=checkpoints
MODEL_EXPORT_PATH=exports

# ==================== 开发和调试配置 ====================
# 开发模式配置（生产环境应关闭）
AUTO_RELOAD=false
SHOW_ERROR_DETAILS=false
ENABLE_API_DOCS=false
ENABLE_SWAGGER_UI=false
ENABLE_REDOC=false

# 调试配置
DEBUG_TOOLBAR_ENABLED=false
PROFILER_ENABLED=false
SQL_DEBUG=false

# 开发工具配置
ENABLE_LINT=false
ENABLE_TYPE_CHECK=false
ENABLE_COVERAGE=false

# ==================== 安全配置 ====================
# 会话安全配置
SESSION_COOKIE_NAME=trademaster_session
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=strict
SESSION_COOKIE_MAX_AGE=86400

# CSRF保护
CSRF_PROTECTION_ENABLED=true
CSRF_COOKIE_NAME=trademaster_csrf
CSRF_HEADER_NAME=X-CSRFToken

# 内容安全策略
CSP_ENABLED=true
CSP_DEFAULT_SRC="'self'"
CSP_SCRIPT_SRC="'self' 'unsafe-inline'"
CSP_STYLE_SRC="'self' 'unsafe-inline'"

# ==================== 时区和国际化配置 ====================
# 时区配置
TIMEZONE=Asia/Shanghai
USE_TZ=true

# 国际化配置
LANGUAGE_CODE=zh-Hans
LANGUAGES=["zh-Hans","en-US"]
LOCALE_PATHS=["locales"]

# ==================== 配置文件使用说明 ====================
#
# 📝 配置步骤:
# 1. 复制此文件为 .env
# 2. 替换所有包含 "CHANGE_THIS" 的值
# 3. 根据部署环境调整数据库和Redis连接信息
# 4. 配置外部服务连接信息
# 5. 设置邮件服务参数
#
# 🔒 安全提醒:
# - SECRET_KEY 必须是强随机字符串
# - 数据库和Redis密码必须设置
# - 生产环境必须关闭调试功能
# - 必须配置HTTPS和安全头
#
# 🚀 性能优化:
# - 根据服务器配置调整连接池大小
# - 配置适当的缓存策略
# - 启用压缩和缓存头
# - 配置CDN加速静态资源
#